install.packages("psych", dependencies = TRUE)
install.packages("FSA")
install.packages("Rmisc")
install.packages("ggplot2")
install.packages("car")
install.packages("multcompView")
install.packages("multcomp")
install.packages("lsmeans")
install.packages("rcompanion")

#Import dataset from csv
Data <- read.csv(file = '/Users/wrsadmin/cve_automation/cve-automations/open_ai_api/HEURISTIC-OPENAI.csv')

Data$CVE_ID <- as.factor(Data$CVE_ID)
Data$Description <- as.factor(Data$DESCRIPTION_LENGHT)
Data$Modules <- as.factor(Data$MODULES_LENGHT)
Data$Time <- as.factor(Data$TIME)
Data$Database <- as.factor(Data$DATABASE)

#Data validation
head(Data)
str(Data)
summary(Data)

interaction.plot(x.factor = Data$CVE_ID,
                 trace.factor = Data$Database,
                 response = Data$Time,
                 fun = mean,
                 type = "b",
                 col = c("black","red","green","cyan","orange"),
                 pch = c(19,17,15),
                 fixed = TRUE,
                 leg.bty = "o")

# Interaction Plot
interaction.plot(
  x.factor = Data$CVE_ID,
  trace.factor = Data$Description,
  response = Data$Time,
  fun = mean,
  type = "b",
  col = c("black", "red", "green"),
  pch = c(19, 17, 15),fixed = TRUE,
  leg.bty = "o"
)


#----1 ANOVA ----
#Lineal Model
model = lm(Time ~ Description * CVE_ID * Modules * Database,
           data = Data)
Anova(model,
      type = "II")
#Residual Normality
x = residuals(model)
plotNormalHistogram(x)
#Homoscedasticity
plot(
  fitted(model),
  residuals(model)
)
#Others Graphics
plot(model)