install.packages("psych")
install.packages("FSA")
install.packages("Rmisc")
install.packages("ggplot2")
install.packages("car")
install.packages("multcompView")
install.packages("multcomp")
install.packages("lsmeans")
install.packages("rcompanion")

#Import dataset from csv
Data <- read.csv(file = 'open_ai_api/results/time_results/overall/test-01.csv')

Data$CVE_ID <- as.factor(Data$CVE_ID)
Data$Analyzer <- as.factor(Data$Analyzer)
Data$Lenght <- as.factor(Data$Lenght)

#Data validation
headTail(Data)
str(Data)
summary(Data)

interaction.plot(x.factor = Data$CVE_ID,
                 trace.factor = Data$Analyzer,
                 response = Data$Time,
                 fun = mean,
                 type = "b",
                 col = c("black","red","green","cyan","orange"),
                 pch = c(19,17,15),
                 fixed = TRUE,
                 leg.bty = "o")

# Interaction Plot
interaction.plot(
  x.factor = Data$Lenght,
  trace.factor = Data$Analyzer,
  response = Data$Time,
  fun = mean,
  type = "b",
  col = c("black", "red", "green"),
  pch = c(19, 17, 15),fixed = TRUE,
  leg.bty = "o"
)


#----1 ANOVA ----
#Lineal Model
model = lm(Time ~ Analyzer * CVE_ID * Lenght,
           data = Data)
Anova(model,
      type = "II")
#Residual Normality
x = residuals(model)
plotNormalHistogram(x)
#Homoscedasticity
plot(
  fitted(model),
  residuals(model)
)
#Others Graphics
plot(model)